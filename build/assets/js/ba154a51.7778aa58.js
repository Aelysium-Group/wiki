"use strict";(self.webpackChunkaelysium_wiki=self.webpackChunkaelysium_wiki||[]).push([[57],{4137:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(n),h=o,m=p["".concat(s,".").concat(h)]||p[h]||u[h]||r;return n?a.createElement(m,i(i({ref:t},d),{},{components:n})):a.createElement(m,i({ref:t},d))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7268:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>y,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var a=n(7462),o=(n(7294),n(4137));const r={},i="\u2935\ufe0f Load Balancing",l={unversionedId:"rusty-connector/docs/concepts/load_balancing",id:"rusty-connector/docs/concepts/load_balancing",title:"\u2935\ufe0f Load Balancing",description:"Load balancing is how  decide which MCLoaders to send players to.",source:"@site/docs/rusty-connector/docs/concepts/load_balancing.mdx",sourceDirName:"rusty-connector/docs/concepts",slug:"/rusty-connector/docs/concepts/load_balancing",permalink:"/rusty-connector/docs/concepts/load_balancing",draft:!1,editUrl:"https://github.com/Aelysium-Group/wiki/docs/rusty-connector/docs/concepts/load_balancing.mdx",tags:[],version:"current",frontMatter:{},sidebar:"plugins_wiki_rusty_connector",previous:{title:"\ud83c\udf0a Liquid Timestamp",permalink:"/rusty-connector/docs/concepts/liquid_timestamps"},next:{title:"\ud83d\udce6 MCLoaders",permalink:"/rusty-connector/docs/concepts/loader"}},s={},c=[{value:"Algorithm",id:"algorithm",level:2},{value:"Weight",id:"weight",level:2},{value:"Persistence",id:"persistence",level:2},{value:"Reading the load balancer in the console",id:"reading-the-load-balancer-in-the-console",level:2}],d=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",t)},p=d("DynamicTag"),u=d("TheLawTag"),h={toc:c},m="wrapper";function y(e){let{components:t,...n}=e;return(0,o.kt)(m,(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"\ufe0f-load-balancing"},"\u2935\ufe0f Load Balancing"),(0,o.kt)("p",null,"Load balancing is how ",(0,o.kt)(p,{emoji:"\u2601\ufe0f",name:"Families",title:"A link to the families page",link:"./concepts/families",mdxType:"DynamicTag"})," decide which MCLoaders to send players to.\nBy utilizing Load Balancers properly, you'll be able to properly ",(0,o.kt)(u,{mdxType:"TheLawTag"},"Think in Terms of Families"),"."),(0,o.kt)("h2",{id:"algorithm"},"Algorithm"),(0,o.kt)("p",null,"Every family in RustyConnector can have its own dedicated load balancer.\nBy default, the load balancer will use the ",(0,o.kt)("a",{parentName:"p",href:"https://www.nginx.com/resources/glossary/round-robin-load-balancing/"},"Round Robin Algorithm")," however you can also use a few other algorithms if you'd like instead."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Round Robin"),(0,o.kt)("p",null,"All Loaders are placed into a queue based on the order they get registered in.",(0,o.kt)("br",null),"Every time a connection occurs, the connection will be routed to the current Loader in the queue and the queue will iterate to the next Loader. Once the load balancer reaches the end of the Loader queue, the load balancer will loop back to the beginning and start again.")),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Most Connection"),(0,o.kt)("p",null,"Connects players to the Loader with the most players currently connected. This mode is best if you want to fill Loaders up as quickly as possible.")),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Least Connection"),(0,o.kt)("p",null,"Connects players to the Loader with the fewest players currently connected. This mode is best if you want evenly distributed players across all Loaders.")),(0,o.kt)("p",null,"Additionally, you can set your algorithm to consider weighted values when it sorts. When the load balancer is weighted you can set the ",(0,o.kt)("inlineCode",{parentName:"p"},"weight")," value in RC-Paper's ",(0,o.kt)("inlineCode",{parentName:"p"},"config.yml")," to cause specific servers to gain priority over others."),(0,o.kt)("h2",{id:"weight"},"Weight"),(0,o.kt)("p",null,"Weight is an attribute you define on your individual MCLoaders. It allows some Loaders to have priority over other loaders.\nThis setting is great for if you have some Loaders which are running on more powerful machines and can handler more players."),(0,o.kt)("p",null,"When setting up weight, you must make sure you specifically enable the ",(0,o.kt)("inlineCode",{parentName:"p"},"weighted")," toggle in your Load Balancer config."),(0,o.kt)("p",null,"Read below to see how the differnt algorithms work when they're weighted."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Weighted Round Robin"),(0,o.kt)("p",null,"All Loaders are placed into a queue based on the order they get registered in. Loaders are then sorted in descending order based on weight level.",(0,o.kt)("br",null),"Every time a connection occurs, the connection will be routed to the current Loader in the queue and the queue will iterate to the next Loader. Once the load balancer reaches the end of the Loader queue, the load balancer will loop back to the beginning and start again.")),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Weighted Most Connection"),(0,o.kt)("p",null,"Connects players to the Loader with the highest weight and most players currently connected. This mode is best if you want to fill Loaders up as quickly as possible.")),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Weighted Least Connection"),(0,o.kt)("p",null,"Connects players to the Loader with the highest weight and least players currently connected. This mode is best if you want evenly distributed players across all Loaders.")),(0,o.kt)("h2",{id:"persistence"},"Persistence"),(0,o.kt)("p",null,"Persistence is a feature that will cause the Proxy to attempt to connect a player to a specific family multiple times before giving up. Consider the following family layout:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},"algorithm: LEAST_CONNECTION\nweighted: true\npersistence: true\nattempts: 5\n   ---| 1. [VIP-whitelist](127.0.0.1:25565) [20 (40 <> 50) w-1000] <<<<<\n   ---| 2. [PrimaryLoader1](127.0.0.1:25566) [40 (40 <> 50) w-100]\n   ---| 3. [PrimaryLoader2](127.0.0.1:25567) [45 (40 <> 50) w-100]\n   ---| 4. [BackupLoader1](127.0.0.1:25568) [3 (40 <> 50) w-0]\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"That was probably a little confusing to look at. For a full breakdown of what all the data means you can read ",(0,o.kt)("a",{parentName:"p",href:"#reading-the-load-balancer-in-the-console"},"this snippet"),".")),(0,o.kt)("p",null,"In the example above, we have four servers registered to a family with a Least Connection Algorithm.\nOne of the servers has its own whitelist allowing only VIP players to join it.\nAdditionally, all servers have a soft-cap of ",(0,o.kt)("inlineCode",{parentName:"p"},"40")," and a hard-cap of ",(0,o.kt)("inlineCode",{parentName:"p"},"50"),". Servers 2 and 3 are both maxed out for regular players."),(0,o.kt)("p",null,"If a player were to attempt to join this family here's a step by step of what would happen:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Player attempts to connect to ",(0,o.kt)("inlineCode",{parentName:"li"},"VIP-whitelist")," connection fails.\nPersistence kicks in. One attempt has been used. Persistence cause's the player's connection to now operate via Round Robin algorithm (this way it will always attempt to connect to a different server until its attempts are used up)"),(0,o.kt)("li",{parentName:"ol"},"Player attempts to connect to PrimaryLoader1. Connection fails. Second attempt has been used."),(0,o.kt)("li",{parentName:"ol"},"Player attempts to connect to PrimaryLoader2. Connection fails. Third attempt has been used."),(0,o.kt)("li",{parentName:"ol"},"Player attempts to connect to BackupLoader1. Connection succeeds. Persistence shut's off."),(0,o.kt)("li",{parentName:"ol"},"Family insertion point returns to original position.")),(0,o.kt)("p",null,"The whole operation happens in a split second and will go unnoticed by your end-users.\nThis system is particularly useful for music events when you want to have VIP, such as artists and sponsors, auto-route to a VIP server. You can weight the VIP server to be at the top of the family queue and enable persistence. Any players that join the family will automatically bounce over the VIP server and fall into one of the public servers."),(0,o.kt)("p",null,"If a player runs out of persistence attempts before they can be connected to a server; their attempt to connect to the specific family will fail."),(0,o.kt)("h2",{id:"reading-the-load-balancer-in-the-console"},"Reading the load balancer in the console"),(0,o.kt)("p",null,"The messages in the load balancer console can be cryptic. Consider the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},"   ---| 1. [VIP-whitelist](127.0.0.1:25565) [20 (40 <> 50) w-1000] <<<<<\n   ---| 2. [PrimaryLoader1](127.0.0.1:25566) [40 (40 <> 50) w-100]\n   ---| 3. [PrimaryLoader2](127.0.0.1:25567) [45 (40 <> 50) w-100]\n   ---| 4. [BackupLoader1](127.0.0.1:25568) [3 (40 <> 50) w-0]\n")),(0,o.kt)("p",null,"Not much is very clear to the human eye. These messages have been written to compress as much useful information together as we can. Because of this let's look at another version that shows what each data point represents:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},"   ---| 1. [ name ]( address ) [player-count (player-soft-cap <> player-hard-cap) weight] <<<<< insertion-point\n   ---| 2. [ loader-name ]( address ) [player-count (player-soft-cap <> player-hard-cap) weight]\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"name")," | Represents the Loader name set in the MCLoader's ",(0,o.kt)("inlineCode",{parentName:"li"},"config.yml"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"address")," | Represents the Loader address set in the MCLoader's ",(0,o.kt)("inlineCode",{parentName:"li"},"config.yml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"player-count")," | Represents the current player count on this Loader."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"player-soft-cap")," | Represents the soft cap of this Loader, set in the MCLoader's ",(0,o.kt)("inlineCode",{parentName:"li"},"config.yml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"player-hard-cap")," | Represents the hard cap of this Loader, set in the MCLoader's ",(0,o.kt)("inlineCode",{parentName:"li"},"config.yml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"weight")," | Represents the weight level of this Loader, set in the MCLoader's ",(0,o.kt)("inlineCode",{parentName:"li"},"config.yml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"insertion-point")," | Shows which Loader a player will attempt to connect to first if they joined that family at that specific moment in time.")))}y.isMDXComponent=!0}}]);